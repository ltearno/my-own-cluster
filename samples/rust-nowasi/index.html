<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Watchdog</title>
</head>

<body>
    <script>
        (async function () {
            const log = msg => document.body.innerHTML += `<div class='msg'>${msg}</div>`

            let status = await (await fetch('status')).json()

            log(`<h2>Status</h2>`)
            for (let serviceName of Object.keys(status.services)) {
                let timestamp = new Date(status.services[serviceName].timestamp / 1000)
                let evtOld = ((new Date().getTime() - timestamp.getTime()) / (60 * 1000)).toFixed(0)
                log(`${serviceName}: il y a <b style='${evtOld>120?'color:red;':''}'>${evtOld} minutes</b> Ã  ${timestamp.toLocaleTimeString('fr-FR', { weekday: 'long', day: 'numeric', month: 'long' })}`)
            }
        })()
    </script>
</body>

</html>